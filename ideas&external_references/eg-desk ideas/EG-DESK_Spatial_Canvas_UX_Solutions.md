# EG-DESK Spatial Canvas UX ì¢…í•© ì†”ë£¨ì…˜

*Last Updated: 2025-10-04*

## ê°œìš”

ì´ ë¬¸ì„œëŠ” EG-DESKì˜ ë¬´í•œ ìº”ë²„ìŠ¤ ê¸°ë°˜ Ambient AI ì›Œí¬ìŠ¤í˜ì´ìŠ¤ êµ¬í˜„ ì‹œ ë°œìƒí•˜ëŠ” 8ê°€ì§€ í•µì‹¬ UX/ê¸°ìˆ  ë¬¸ì œì— ëŒ€í•œ ì¢…í•© ì†”ë£¨ì…˜ì„ ì œì‹œí•©ë‹ˆë‹¤.

---

## ë¬¸ì œ #1 & #8: ê±°ë¦¬ê°€ ë¨¼ ìš”ì†Œ ì„ íƒ ë° í´ëŸ¬ìŠ¤í„° ê°„ ì´ë™

### ë¬¸ì œ ì •ì˜

**ë¬¸ì œ**: ë©€ë¦¬ ë–¨ì–´ì§„ ë‘ ìš”ì†Œë¥¼ ë¬¶ê±°ë‚˜ í´ëŸ¬ìŠ¤í„° ê°„ ì´ë™ ì‹œ pan/zoomì´ ë¶ˆí¸í•¨

**ì—°êµ¬ ë°œê²¬ì‚¬í•­**:
- **Figma**: ë„¤ì´í‹°ë¸Œ minimap ì—†ìŒ (ì»¤ë®¤ë‹ˆí‹° ìš”ì²­ ë§ìŒ), ê²€ìƒ‰-íˆ¬-í”„ë ˆì„ ê¸°ëŠ¥ ì—†ìŒ
- **Miro**: í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ (í™”ì‚´í‘œë¡œ pan, Cmd+/- zoom), 50+ ë‹¨ì¶•í‚¤
- **Figma Minimap í”ŒëŸ¬ê·¸ì¸**: í´ë¦­ í•œë²ˆì— ìº”ë²„ìŠ¤ ìœ„ì¹˜ ì í”„

### ì†”ë£¨ì…˜ ì œì•ˆ

#### 1. Command Palette í™•ì¥ - Quick Jump

```
Cmd+K â†’ "Jump to [ê²€ìƒ‰ì–´]"
- ìš”ì†Œ ì´ë¦„, íƒœê·¸, í´ëŸ¬ìŠ¤í„°ëª… ê²€ìƒ‰
- í¼ì§€ ë§¤ì¹­ìœ¼ë¡œ ë¹ ë¥¸ ì ‘ê·¼
- ìµœê·¼ ë°©ë¬¸ ìš”ì†Œ íˆìŠ¤í† ë¦¬
```

#### 2. Minimap (ìš°ì¸¡ í•˜ë‹¨)

```
Canvas ì „ì²´ ì¶•ì†Œ ë·°
- í˜„ì¬ viewport ë°•ìŠ¤ í‘œì‹œ
- í´ëŸ¬ìŠ¤í„° ì˜ì—­ í•˜ì´ë¼ì´íŠ¸
- í´ë¦­ìœ¼ë¡œ ì¦‰ì‹œ ì´ë™
- í† ê¸€ ë‹¨ì¶•í‚¤: Cmd+M
```

#### 3. Multi-Select Across Distance (Lasso+)

```
Shift+ë“œë˜ê·¸: ì „í†µì  ì˜ì—­ ì„ íƒ
Cmd+í´ë¦­: ê°œë³„ ìš”ì†Œ ì¶”ê°€ ì„ íƒ (ê±°ë¦¬ ë¬´ê´€)
Cmd+Shift+ë“œë˜ê·¸: ê±°ë¦¬ ë¬´ê´€ "ë§¤ì§ ë¼ì˜"
  â†’ ì„ íƒëœ ìš”ì†Œë“¤ ì‚¬ì´ ì—°ê²°ì„  ìë™ ìƒì„±
  â†’ "ì´ ìš”ì†Œë“¤ì„ ì»¨í…ìŠ¤íŠ¸ë¡œ AI í˜¸ì¶œ" ë²„íŠ¼ í‘œì‹œ
```

#### 4. ë¶ë§ˆí¬/ì•µì»¤ ì‹œìŠ¤í…œ

```
ìš°í´ë¦­ â†’ "Create Bookmark Here"
Cmd+1~9: ë¶ë§ˆí¬ ì €ì¥/ì í”„
ì‚¬ì´ë“œë°”ì— ë¶ë§ˆí¬ ë¦¬ìŠ¤íŠ¸
í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì— ìë™ ì•µì»¤ ìƒì„±
```

---

## ë¬¸ì œ #2: Multi-Viewport ë Œë”ë§ ê¸°ìˆ ì  ê°€ëŠ¥ì„±

### ë¬¸ì œ ì •ì˜

**ë¬¸ì œ**: í•˜ë‚˜ì˜ ë¸Œë¼ìš°ì € ì—”ì§„ë§Œ ì‹¤í–‰, ì—¬ëŸ¬ ê³³ì—ì„œ ì‹œê°ì  ë Œë”ë§ ê°€ëŠ¥í•œê°€?

**ì—°êµ¬ ë°œê²¬ì‚¬í•­**:
- **Electron WebContentsView (v30+)**: BrowserView ëŒ€ì²´, ì—¬ëŸ¬ ë·° íƒ€ì¼ë§ ê°€ëŠ¥
- **Offscreen Rendering**: `paint` ì´ë²¤íŠ¸ë¡œ bitmap/GPU texture ì¶”ì¶œ ê°€ëŠ¥
- **React Portals**: ë©€í‹° ìœˆë„ìš° ì•± êµ¬ì¡°, CSS ë™ê¸°í™” ë³µì¡
- ê° BrowserWindow = ë³„ë„ renderer process (ì™„ì „ ê²©ë¦¬)

### ì†”ë£¨ì…˜ ì œì•ˆ

#### ë°©ì•ˆ A: Offscreen Rendering + Canvas Clone (ì¶”ì²œ)

```typescript
// ë©”ì¸ WebContentsView (ì‹¤ì œ ë¸Œë¼ìš°ì € ì¸ìŠ¤í„´ìŠ¤)
const mainView = new WebContentsView({
  webPreferences: {
    offscreenRendering: true,
    useSharedTexture: true  // GPU ê°€ì†
  }
});

// Paint ì´ë²¤íŠ¸ë¡œ í”„ë ˆì„ ìº¡ì²˜
mainView.webContents.on('paint', (event, dirty, image) => {
  // image.toBitmap() ë˜ëŠ” event.texture ì‚¬ìš©
  const frame = image.toPNG();

  // ìº”ë²„ìŠ¤ì˜ "ë¯¸ëŸ¬ ìš”ì†Œ"ë“¤ì— ë¸Œë¡œë“œìºìŠ¤íŠ¸
  mirrorElements.forEach(el => {
    el.updateFrame(frame);  // <canvas> ë˜ëŠ” <img> ì—…ë°ì´íŠ¸
  });
});
```

**íŠ¹ì§•**:
- âœ… ì§„ì§œ í•˜ë‚˜ì˜ ë¸Œë¼ìš°ì € ì¸ìŠ¤í„´ìŠ¤ (ë©”ëª¨ë¦¬ íš¨ìœ¨)
- âœ… ì—¬ëŸ¬ ìº”ë²„ìŠ¤ ìœ„ì¹˜ì— ë™ì¼ ë Œë”ë§ í‘œì‹œ
- âœ… ë¯¸ëŸ¬ëŠ” "ì½ê¸° ì „ìš©" ìŠ¤ëƒ…ìƒ· (í´ë¦­í•˜ë©´ ë©”ì¸ìœ¼ë¡œ í¬ì»¤ìŠ¤ ì´ë™)
- âš ï¸ 60fps ë™ê¸°í™” ì‹œ ì„±ëŠ¥ ê³ ë ¤ í•„ìš” (requestAnimationFrame ìµœì í™”)

#### ë°©ì•ˆ B: Multiple WebContentsView (ë…ë¦½ ì¸ìŠ¤í„´ìŠ¤)

```typescript
// ê° ìº”ë²„ìŠ¤ ìœ„ì¹˜ë§ˆë‹¤ ë³„ë„ WebContentsView
const view1 = new WebContentsView({ /* ... */ });
const view2 = new WebContentsView({ /* ... */ });

// ê°™ì€ URL ë¡œë“œ
view1.webContents.loadURL('https://example.com');
view2.webContents.loadURL('https://example.com');
```

**íŠ¹ì§•**:
- âœ… ê° ë·°ê°€ ë…ë¦½ì ìœ¼ë¡œ ìŠ¤í¬ë¡¤/ì¸í„°ë™ì…˜ ê°€ëŠ¥
- âŒ ë©”ëª¨ë¦¬ 2ë°° ì†Œë¹„ (ë³„ë„ renderer process)
- âŒ ìƒíƒœ ë™ê¸°í™” ì–´ë ¤ì›€ (ë¡œê·¸ì¸, ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ë“±)

#### ë°©ì•ˆ C: í•˜ì´ë¸Œë¦¬ë“œ - "Reference Card"

```typescript
interface CanvasElement {
  type: 'primary' | 'reference';
  sourceViewId?: string;  // referenceì¸ ê²½ìš° ì›ë³¸ ì°¸ì¡°
}

// Primary: ì‹¤ì œ WebContentsView
// Reference: ì£¼ê¸°ì  ìŠ¤í¬ë¦°ìƒ· + "Open Primary" ë²„íŠ¼
```

**ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤**:
1. ì‚¬ìš©ìê°€ ë¸Œë¼ìš°ì €ë¥¼ ìº”ë²„ìŠ¤ì— ë°°ì¹˜ (Primary)
2. ì‚¬ìš©ìê°€ Cmd+Dë¡œ "Reference ë³µì‚¬" ìƒì„±
3. ReferenceëŠ” 5ì´ˆë§ˆë‹¤ ìŠ¤í¬ë¦°ìƒ· ì—…ë°ì´íŠ¸ (ë˜ëŠ” ìˆ˜ë™)
4. Reference í´ë¦­ â†’ Primaryë¡œ viewport ì´ë™

---

## ë¬¸ì œ #3 & #4: Context ê´€ë¦¬ - ì„±ëŠ¥ vs UI

### ë¬¸ì œ ì •ì˜

**ë¬¸ì œ**:
- UIì—ì„œëŠ” ëŒ€í™”ë‚´ì—­ ì‹ ê²½ ì•ˆì“°ì§€ë§Œ, ì„±ëŠ¥/ë¹„ìš© ê´€ì ì—ì„œëŠ” compartmentalized context ê´€ë¦¬ í•„ìˆ˜
- í”„ë¡œì íŠ¸ë³„, ì‹œê°„ëŒ€ë³„ ë¶„ë¥˜í•˜ì—¬ context ê³µê¸‰í•´ì•¼ cost ì ˆê° + ì„±ëŠ¥ í–¥ìƒ
- Expert userë¥¼ ìœ„í•œ ê´€ë¦¬ UI í•„ìš”, ë˜ëŠ” AIì˜ ìë™ ê´€ë¦¬ ì‹œìŠ¤í…œ

**ì—°êµ¬ ë°œê²¬ì‚¬í•­**:
- **Context Engineering (2025)**: ê³µì‹ í•™ë¬¸ ë¶„ì•¼ë¡œ ë“±ì¥
- **Hierarchical Memory**: Working memory (context window) + Long-term (RAG/vector DB)
- **MemGPT ì ‘ê·¼**: Orchestratorê°€ working memoryì— ë¬´ì—‡ì„ ì˜¬ë¦´ì§€ ê²°ì •
- **ì„±ëŠ¥ í•œê³„**: 32K í† í° ì´ˆê³¼ ì‹œ ì •í™•ë„ ê¸‰ê²©íˆ í•˜ë½ (2M í† í° í•œê³„ í‘œê¸°ì™€ ë¬´ê´€)

### ì†”ë£¨ì…˜: 3-Tier Context Hierarchy

#### ì•„í‚¤í…ì²˜

```typescript
interface ContextTier {
  // Tier 1: Active Working Memory (í•­ìƒ ë¡œë“œ)
  activeContext: {
    currentViewport: Element[];       // í™”ë©´ì— ë³´ì´ëŠ” ìš”ì†Œë“¤
    selectedElements: Element[];      // ìœ ì €ê°€ ì„ íƒí•œ ìš”ì†Œë“¤
    recentConversation: Message[];    // ìµœê·¼ 10ê°œ ë©”ì‹œì§€
    workflowState: WorkflowMetadata;  // í˜„ì¬ ì›Œí¬í”Œë¡œìš° ìƒíƒœ
  };

  // Tier 2: Project Memory (ìš”ì²­ ì‹œ ë¡œë“œ)
  projectContext: {
    clusterID: string;
    projectMetadata: ProjectInfo;
    conversationHistory: Message[];   // ì´ í”„ë¡œì íŠ¸ì˜ ì „ì²´ ëŒ€í™”
    relatedElements: Element[];       // í´ëŸ¬ìŠ¤í„° ë‚´ ëª¨ë“  ìš”ì†Œ
    embeddedVectors: VectorIndex;     // RAGìš© ë²¡í„° DB
  }[];

  // Tier 3: Archive (ê²€ìƒ‰ìœ¼ë¡œë§Œ ì ‘ê·¼)
  archivedContext: {
    timestamp: Date;
    projectID: string;
    conversationSnapshot: Message[];
    canvasSnapshot: Image;
    vectorIndex: VectorIndex;
  }[];
}
```

#### AI Orchestrator - ìë™ Context ê´€ë¦¬

```typescript
class ContextOrchestrator {
  async prepareContext(userPrompt: string): Promise<ContextPayload> {
    // 1. Active Context (í•­ìƒ í¬í•¨)
    const activeCtx = this.getActiveContext();

    // 2. Relevance Score ê³„ì‚°
    const projectScores = this.projects.map(p => ({
      project: p,
      score: this.calculateRelevance(userPrompt, p)
    }));

    // 3. Top-K Projectsë§Œ ë¡œë“œ (K=3)
    const relevantProjects = projectScores
      .sort((a, b) => b.score - a.score)
      .slice(0, 3)
      .map(p => p.project.context);

    // 4. Token Budget ê³„ì‚°
    const totalTokens = this.estimateTokens(activeCtx)
                      + this.estimateTokens(relevantProjects);

    if (totalTokens > 30000) {
      // 5. Compression: ìš”ì•½ ë˜ëŠ” ì¼ë¶€ ì œì™¸
      return this.compressContext(activeCtx, relevantProjects);
    }

    return { activeCtx, relevantProjects };
  }

  calculateRelevance(prompt: string, project: Project): number {
    // Embedding ìœ ì‚¬ë„ + Spatial proximity + Recency
    const embedding = this.embedPrompt(prompt);
    const similarity = cosineSimilarity(embedding, project.embedding);
    const spatial = project.elements.some(el =>
      this.viewport.contains(el)
    ) ? 0.3 : 0;
    const recency = this.getRecencyScore(project.lastAccessed);

    return similarity * 0.5 + spatial * 0.3 + recency * 0.2;
  }
}
```

#### Expert User Management UI

**íŒ¨ë„ êµ¬ì¡°** (ì¢Œì¸¡ ì‚¬ì´ë“œë°” í™•ì¥):

```
â”Œâ”€ Context Manager â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Active] ğŸŸ¢                   â”‚
â”‚  â””â”€ Current Viewport (2.3K)   â”‚
â”‚  â””â”€ Selected Elements (1.5K)  â”‚
â”‚  â””â”€ Recent Messages (5.2K)    â”‚
â”‚  â””â”€ Total: 9K tokens          â”‚
â”‚                               â”‚
â”‚ [Projects] ğŸ“                 â”‚
â”‚  â”œâ”€ Tax Report Q4 (15K) â­    â”‚  â† í˜„ì¬ í™œì„±
â”‚  â”œâ”€ Marketing Campaign (8K)   â”‚
â”‚  â””â”€ Client Onboarding (12K)   â”‚
â”‚                               â”‚
â”‚ [Archives] ğŸ“¦                 â”‚
â”‚  â”œâ”€ 2025-09-15 ~ 2025-09-30   â”‚
â”‚  â””â”€ 2025-08-01 ~ 2025-08-31   â”‚
â”‚                               â”‚
â”‚ [AI Auto-Manage] ğŸ¤–           â”‚
â”‚  â””â”€ "í”„ë¡œì íŠ¸ ìë™ ë¶„ë¥˜"       â”‚
â”‚  â””â”€ "ì˜¤ë˜ëœ ëŒ€í™” ìë™ ì••ì¶•"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ê¸°ëŠ¥**:
- **Drag-and-drop**: ë©”ì‹œì§€ë¥¼ í”„ë¡œì íŠ¸ ê°„ ì´ë™
- **Manual Archive**: í”„ë¡œì íŠ¸ë¥¼ Archiveë¡œ ìˆ˜ë™ ì´ë™
- **Token Budget Alert**: 30K ì´ˆê³¼ ì‹œ ê²½ê³  + ì••ì¶• ì œì•ˆ
- **Context Preview**: ê° í”„ë¡œì íŠ¸ í´ë¦­ ì‹œ "ì–´ë–¤ ì •ë³´ê°€ í¬í•¨ë˜ëŠ”ì§€" ë¯¸ë¦¬ë³´ê¸°

#### AI ìë™ ê´€ë¦¬ ì‹œìŠ¤í…œ

```typescript
class AutoContextManager {
  // ê·œì¹™ 1: ì‹œê°„ ê¸°ë°˜ ìë™ ì•„ì¹´ì´ë¹™
  async autoArchive() {
    const oldProjects = this.projects.filter(p =>
      p.lastAccessed < Date.now() - 30 * 24 * 60 * 60 * 1000  // 30ì¼
    );

    for (const project of oldProjects) {
      await this.archiveProject(project);
      this.notify(`"${project.name}" ì•„ì¹´ì´ë¹™ë¨ (30ì¼ ë¯¸ì‚¬ìš©)`);
    }
  }

  // ê·œì¹™ 2: ê³µê°„ ê¸°ë°˜ ìë™ í´ëŸ¬ìŠ¤í„°ë§
  async autoCluster() {
    const unassignedElements = this.canvas.elements.filter(el =>
      !el.projectID
    );

    // DBSCAN í´ëŸ¬ìŠ¤í„°ë§ (proximity ê¸°ë°˜)
    const clusters = this.dbscan(unassignedElements, {
      eps: 200,  // 200px ì´ë‚´ë©´ ê°™ì€ í´ëŸ¬ìŠ¤í„°
      minPts: 2
    });

    clusters.forEach((cluster, idx) => {
      const projectName = this.generateProjectName(cluster);  // AI ìƒì„±
      this.createProject(projectName, cluster);
    });
  }

  // ê·œì¹™ 3: Conversation ìš”ì•½ (ê¸´ íˆìŠ¤í† ë¦¬)
  async summarizeConversation(project: Project) {
    if (project.messages.length > 50) {
      const summary = await this.llm.summarize(project.messages);
      project.conversationSummary = summary;
      project.messages = project.messages.slice(-10);  // ìµœê·¼ 10ê°œë§Œ ìœ ì§€
    }
  }
}
```

---

## ë¬¸ì œ #5: Spatial Proximity Model ê°œì„ 

### ìœ ì € í”¼ë“œë°±

- âŒ ì™¼ìª½â†’ì˜¤ë¥¸ìª½ ë°°ì¹˜ ì•„ë‹˜
- âœ… ë™ì„œë‚¨ë¶ ë°©í–¥ìœ¼ë¡œ proximity
- âœ… í™”ì‚´í‘œ ë°©í–¥ì€ êµ¿
- âœ… í´ëŸ¬ìŠ¤í„° í˜•ì„± â†’ ê°œë³„ í”„ë¡œì íŠ¸ ë¶„ë¥˜
- **í•µì‹¬**: í˜„ì¬ viewportì— ë³´ì´ëŠ” ìš”ì†Œë“¤ = í•˜ë‚˜ì˜ ì „ì²´ context (ì•ˆë³´ì´ë©´ ìš°ì„ ë„ ë‚®ìŒ)

### ì—…ë°ì´íŠ¸ëœ Spatial Context ì—”ì§„

```typescript
interface SpatialContextEngine {
  // Viewport-First ì ‘ê·¼
  calculateContext(userFocus: Element): ContextMap {
    const viewport = this.getCurrentViewport();

    // 1. Viewport ë‚´ë¶€ ìš”ì†Œ = Primary Context
    const visibleElements = this.canvas.elements.filter(el =>
      viewport.intersects(el.bounds)
    );

    // 2. Omni-directional Proximity (ë™ì„œë‚¨ë¶)
    const proximityMap = visibleElements.map(el => ({
      element: el,
      distance: this.calculateDistance(userFocus, el),
      direction: this.getDirection(userFocus, el),  // N, NE, E, SE, S, SW, W, NW
      relevance: this.calculateRelevance(userFocus, el, viewport)
    }));

    // 3. Out-of-viewport elements = Secondary Context (ë‚®ì€ ìš°ì„ ë„)
    const hiddenElements = this.canvas.elements.filter(el =>
      !viewport.intersects(el.bounds)
    ).map(el => ({
      element: el,
      relevance: 0.1,  // ë§¤ìš° ë‚®ì€ ê¸°ë³¸ relevance
      reason: 'out-of-viewport'
    }));

    return {
      primary: proximityMap.sort((a, b) => b.relevance - a.relevance),
      secondary: hiddenElements
    };
  }

  calculateRelevance(focus: Element, target: Element, viewport: Viewport): number {
    const distance = this.calculateDistance(focus, target);
    const inViewport = viewport.intersects(target.bounds) ? 1.0 : 0.1;

    // Gestalt Proximity: ê±°ë¦¬ ì—­ì œê³± ë²•ì¹™
    const proximityScore = Math.max(0, 1 - (distance / 500) ** 2);

    // Arrow connection boost
    const hasArrow = this.canvas.arrows.some(a =>
      (a.from === focus.id && a.to === target.id) ||
      (a.from === target.id && a.to === focus.id)
    );
    const arrowBoost = hasArrow ? 0.3 : 0;

    // Cluster membership boost
    const sameCluster = focus.clusterID === target.clusterID;
    const clusterBoost = sameCluster ? 0.2 : 0;

    return (proximityScore * 0.5 + arrowBoost + clusterBoost) * inViewport;
  }

  getDirection(from: Element, to: Element): Direction {
    const dx = to.position.x - from.position.x;
    const dy = to.position.y - from.position.y;
    const angle = Math.atan2(dy, dx) * 180 / Math.PI;

    // 8ë°©í–¥ ë¶„ë¥˜
    if (angle >= -22.5 && angle < 22.5) return 'E';
    if (angle >= 22.5 && angle < 67.5) return 'SE';
    if (angle >= 67.5 && angle < 112.5) return 'S';
    if (angle >= 112.5 && angle < 157.5) return 'SW';
    // ... (ë‚˜ë¨¸ì§€ ë°©í–¥)
  }
}
```

### Viewport Context ì‹œê°í™”

```
í˜„ì¬ Viewport:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Excel]     â†’    [Browser]     â”‚  â† ë³´ì„ (Relevance 1.0)
â”‚    â†“                             â”‚
â”‚  [Email Draft]                   â”‚  â† ë³´ì„ (Relevance 0.85)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Viewport ë°–:
      [Slack]  â† ì•ˆë³´ì„ (Relevance 0.1)
```

### AI Prompt êµ¬ì„±

```
ë‹¹ì‹ ì˜ í˜„ì¬ ì‘ì—… ì»¨í…ìŠ¤íŠ¸:

[Primary - Viewport ë‚´ë¶€]
1. Excel ìŠ¤í”„ë ˆë“œì‹œíŠ¸ (ì¤‘ì‹¬, 100% relevance)
2. Browser - HomeTax (50px ë™ìª½, 95% relevance, í™”ì‚´í‘œ ì—°ê²°)
3. Email Draft (70px ë‚¨ìª½, 85% relevance)

[Secondary - Viewport ì™¸ë¶€]
4. Slack ëŒ€í™” (500px ì„œìª½, 10% relevance, í˜„ì¬ í™”ë©´ ë°–)

ì‚¬ìš©ì ìš”ì²­: "VAT ë°ì´í„° ì¶”ì¶œí•´ì¤˜"
â†’ AIëŠ” Browser(HomeTax)ì™€ Excelì— ì§‘ì¤‘, Slackì€ ë¬´ì‹œ
```

---

## ë¬¸ì œ #6: Context Feeding ì „ëµ ëª…í™•í™”

### ìœ ì €ì˜ í•´ê²°ì±…

> "ìœ ì €ê°€ ìº”ë²„ìŠ¤ ìœ„ì˜ ìš”ì†Œë¥¼ ì—¬ëŸ¬ê°œ ì„ íƒí•  ìˆ˜ ìˆëŠ”ë° ê·¸ë ‡ê²Œ í•˜ë©´ ì•ˆì˜ ë‚´ìš©ì´ promptì— ì²¨ë¶€ë˜ê³ , í™”ë©´ì— ë³´ì´ëŠ” ìš”ì†ŒëŠ” referenceë§Œ ë³´ì—¬ì§€ëŠ”ê±°ì§€. ê·¸ë‹¤ìŒì—ëŠ” aiê°€ ì•Œì•„ì„œ tool callingí•˜ëŠ”ê±°ê³ ."

### ìµœì¢… Context Feeding ì•„í‚¤í…ì²˜

```typescript
interface ContextFeedingStrategy {
  // 1. User-Selected Elements â†’ Full Content Attachment
  selectedElements: {
    element: Element;
    fullContent: string | Buffer;  // ì „ì²´ ë‚´ìš© ì²¨ë¶€
    attachmentType: 'text' | 'image' | 'pdf' | 'webpage';
  }[];

  // 2. Visible (Non-Selected) Elements â†’ Reference Only
  visibleReferences: {
    element: Element;
    metadata: {
      type: string;
      title: string;
      preview: string;  // 100ì ë¯¸ë¦¬ë³´ê¸°
      url?: string;
    };
  }[];

  // 3. AI Tool Calling for Additional Data
  availableTools: Tool[];
}

class PromptBuilder {
  buildPrompt(userInput: string, context: ContextFeedingStrategy): string {
    let prompt = `# ì‚¬ìš©ì ì…ë ¥\n${userInput}\n\n`;

    // User-selected: Full content
    if (context.selectedElements.length > 0) {
      prompt += `# ì²¨ë¶€ëœ ìë£Œ (ì‚¬ìš©ìê°€ ì„ íƒí•¨)\n`;
      context.selectedElements.forEach((sel, i) => {
        prompt += `\n## ìë£Œ ${i+1}: ${sel.element.title}\n`;
        prompt += sel.fullContent + '\n';
      });
    }

    // Visible: Reference only
    if (context.visibleReferences.length > 0) {
      prompt += `\n# ì°¸ì¡° ê°€ëŠ¥í•œ ìë£Œ (í™”ë©´ì— ë³´ì„, í•„ìš”ì‹œ toolë¡œ ì ‘ê·¼)\n`;
      context.visibleReferences.forEach(ref => {
        prompt += `- ${ref.metadata.type}: "${ref.metadata.title}"\n`;
        prompt += `  Preview: ${ref.metadata.preview}\n`;
      });
    }

    // Tool instructions
    prompt += `\n# ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬\n`;
    prompt += `- readElement(elementId): íŠ¹ì • ìš”ì†Œì˜ ì „ì²´ ë‚´ìš© ì½ê¸°\n`;
    prompt += `- searchCanvas(query): ìº”ë²„ìŠ¤ì—ì„œ ê´€ë ¨ ìš”ì†Œ ê²€ìƒ‰\n`;
    prompt += `- navigateWeb(elementId, action): ë¸Œë¼ìš°ì € ìš”ì†Œ ì œì–´\n`;

    return prompt;
  }
}
```

### ì‚¬ìš© ì˜ˆì‹œ

#### ì‹œë‚˜ë¦¬ì˜¤ 1: íŒŒì¼ ë³‘í•© ìš”ì²­

```
ìœ ì € í–‰ë™:
1. Cmd+í´ë¦­ìœ¼ë¡œ [AíŒŒì¼], [BíŒŒì¼] ì„ íƒ
2. Cmd+K â†’ "ì´ ë‘ íŒŒì¼ ë³‘í•©í•´ì¤˜"

AIê°€ ë°›ëŠ” Prompt:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì‚¬ìš©ì ì…ë ¥
ì´ ë‘ íŒŒì¼ ë³‘í•©í•´ì¤˜

# ì²¨ë¶€ëœ ìë£Œ (ì‚¬ìš©ìê°€ ì„ íƒí•¨)
## ìë£Œ 1: quarterly_report.xlsx
[ì „ì²´ ì—‘ì…€ ë°ì´í„°...]

## ìë£Œ 2: sales_data.csv
[ì „ì²´ CSV ë°ì´í„°...]

# ì°¸ì¡° ê°€ëŠ¥í•œ ìë£Œ (í™”ë©´ì— ë³´ì„)
- Email Draft: "Q4 Report Final"
  Preview: "Dear team, Please find attached..."
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â†’ AIëŠ” A, B íŒŒì¼ ì „ì²´ ë‚´ìš©ì„ ì§ì ‘ ë°›ìŒ
â†’ Email DraftëŠ” referenceë§Œ, í•„ìš”í•˜ë©´ readElement() í˜¸ì¶œ
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ìš”ì†Œ ë¯¸ì„ íƒ ì‹œ

```
ìœ ì € í–‰ë™:
1. ì•„ë¬´ê²ƒë„ ì„ íƒ ì•ˆí•¨
2. Cmd+K â†’ "HomeTaxì—ì„œ VAT ë°ì´í„° ê°€ì ¸ì™€ì¤˜"

AIê°€ ë°›ëŠ” Prompt:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì‚¬ìš©ì ì…ë ¥
HomeTaxì—ì„œ VAT ë°ì´í„° ê°€ì ¸ì™€ì¤˜

# ì°¸ì¡° ê°€ëŠ¥í•œ ìë£Œ (í™”ë©´ì— ë³´ì„)
- Browser: "HomeTax ë¶€ê°€ì„¸ ì‹ ê³ "
  Preview: "êµ­ì„¸ì²­ í™ˆíƒìŠ¤ - ë¶€ê°€ê°€ì¹˜ì„¸ ì‹ ê³ ..."
- Excel: "Q4_VAT_Report.xlsx"
  Preview: "Sheet1: ë‚ ì§œ, ê³µê¸‰ê°€ì•¡, ì„¸ì•¡..."

# ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬
- readElement(elementId): íŠ¹ì • ìš”ì†Œì˜ ì „ì²´ ë‚´ìš© ì½ê¸°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

AI ì‹¤í–‰:
1. "HomeTax" ì–¸ê¸‰ ê°ì§€
2. readElement('browser-hometax-id') í˜¸ì¶œ
3. ë¸Œë¼ìš°ì € DOM ìŠ¤í¬ë˜í•‘ or screenshot ë¶„ì„
4. Excel íŒŒì¼ì— ë°ì´í„° ì…ë ¥
```

---

## ë¬¸ì œ #7: AI ì‹¤í–‰ ê³¼ì • ë° ê²°ê³¼ë¥¼ ìº”ë²„ìŠ¤ì— ì‹œê°í™”

### ìœ ì € ì•„ì´ë””ì–´

> "aiê°€ 'ê³„íšì„ ì„¸ì› ìŠµë‹ˆë‹¤. ì»¨íŒë°›ê¸° ìœ„í•´ ì œ ì„¤ëª…ì„ ë”°ë¼ì™€ì£¼ì„¸ìš”' í•˜ê³  ì±„íŒ…ì°½ì— ë²„íŠ¼ì´ ìƒê¸°ëŠ”ë° ê·¸ê±° ëˆ„ë¥´ë©´ í•´ë‹¹ ìº”ë²„ìŠ¤ ìš”ì†Œë¡œ í™”ë©´ì´ ì´ë™í•˜ê³  ë‹¤ìŒë‹¤ìŒ ëˆŒëŸ¬ì„œ ë‹¤ìŒ ë‹¨ê³„ì— í•´ë‹¹í•˜ëŠ” ìš”ì†Œë¡œ ì´ë™í•˜ëŠ”ê±°ì§€. ê³„íš ì„¤ëª…ë„ ìš”ì†Œ ì˜†ì— ì»¤ë©˜íŠ¸ë¡œ ë³´ì—¬ì£¼ê³ . ê²°ê³¼ ë¦¬í¬íŠ¸ë„ ë§ˆì°¬ê°€ì§€."

### ì†”ë£¨ì…˜: Canvas-Integrated Workflow Visualization

#### 1. AI ê³„íš ë‹¨ê³„ - "Guided Tour" ëª¨ë“œ

```typescript
interface WorkflowPlan {
  steps: WorkflowStep[];
  status: 'draft' | 'approved' | 'executing' | 'completed';
}

interface WorkflowStep {
  id: string;
  targetElement: Element;
  action: string;
  description: string;
  position: { x: number, y: number };  // ìº”ë²„ìŠ¤ ì¢Œí‘œ
  status: 'pending' | 'current' | 'completed' | 'error';
}

class WorkflowVisualizer {
  async showPlan(plan: WorkflowPlan) {
    // Command Paletteì— ê³„íš ì¹´ë“œ í‘œì‹œ
    const planCard = `
      ğŸ“‹ AIê°€ ê³„íšì„ ì„¸ì› ìŠµë‹ˆë‹¤ (${plan.steps.length}ë‹¨ê³„)

      [ë¯¸ë¦¬ë³´ê¸° ğŸ”] [ì‹¤í–‰ âœ…] [ìˆ˜ì • âœï¸]
    `;

    this.commandPalette.show(planCard);
  }

  async startGuidedTour(plan: WorkflowPlan) {
    for (let i = 0; i < plan.steps.length; i++) {
      const step = plan.steps[i];

      // 1. í•´ë‹¹ ìš”ì†Œë¡œ viewport ì´ë™ (ì• ë‹ˆë©”ì´ì…˜)
      await this.canvas.panTo(step.targetElement, {
        duration: 500,
        zoom: 1.2  // ì•½ê°„ í™•ëŒ€
      });

      // 2. ìš”ì†Œ ì˜†ì— Comment Bubble í‘œì‹œ
      this.showComment(step.targetElement, {
        title: `Step ${i+1}/${plan.steps.length}`,
        description: step.description,
        action: step.action
      });

      // 3. Navigation UI í‘œì‹œ (ìš°ì¸¡ í•˜ë‹¨)
      this.showNavigationControl({
        current: i + 1,
        total: plan.steps.length,
        onNext: () => this.nextStep(),
        onPrev: () => this.prevStep(),
        onApprove: () => this.executePlan(plan),
        onReject: () => this.cancelPlan()
      });

      // 4. ì‚¬ìš©ì ì•¡ì…˜ ëŒ€ê¸°
      await this.waitForUserAction();
    }
  }

  showComment(element: Element, comment: StepComment) {
    const bubble = `
    â”Œâ”€ AI Comment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ${comment.title}              â”‚
    â”‚                               â”‚
    â”‚ ${comment.description}        â”‚
    â”‚                               â”‚
    â”‚ ìˆ˜í–‰í•  ì‘ì—…:                   â”‚
    â”‚ ${comment.action}             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
      [Element]
    `;

    this.canvas.addOverlay(bubble, {
      anchorTo: element,
      position: 'top-left',
      style: 'speech-bubble'
    });
  }
}
```

**UI ì˜ˆì‹œ**:

```
Canvas View:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚  â”Œâ”€ Step 2/5 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ HomeTaxì—ì„œ VAT ë°ì´í„°  â”‚            â”‚
â”‚  â”‚ ì¶”ì¶œí•˜ê¸°                â”‚            â”‚
â”‚  â”‚                         â”‚            â”‚
â”‚  â”‚ ì‘ì—…: í…Œì´ë¸” ìŠ¤í¬ë˜í•‘    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚             â†“                           â”‚
â”‚      [ğŸŒ HomeTax Browser]               â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”‚               [â—€ ì´ì „]  [ìŠ¹ì¸ âœ…]  [ë‹¤ìŒ â–¶] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. AI ì‹¤í–‰ ë‹¨ê³„ - Live Progress Visualization

```typescript
class ExecutionVisualizer {
  async executeWithVisualization(plan: WorkflowPlan) {
    for (const step of plan.steps) {
      step.status = 'current';

      // 1. Stepì— Progress Indicator í‘œì‹œ
      this.showProgressIndicator(step.targetElement, {
        type: 'spinner',
        message: step.action
      });

      // 2. ì‹¤ì œ ì‘ì—… ìˆ˜í–‰
      try {
        const result = await this.executor.execute(step);

        // 3. ì„±ê³µ ì‹œ ì²´í¬ë§ˆí¬
        step.status = 'completed';
        this.showSuccess(step.targetElement);

        // 4. ê²°ê³¼ë¬¼ì´ ìƒˆ ìš”ì†Œë©´ ìº”ë²„ìŠ¤ì— ì¶”ê°€
        if (result.newElement) {
          const newEl = await this.canvas.addElement(result.newElement, {
            position: this.calculatePosition(step.targetElement),
            animation: 'fade-in'
          });

          // 5. ì›ë³¸ ìš”ì†Œì™€ í™”ì‚´í‘œ ì—°ê²°
          this.canvas.addArrow(step.targetElement, newEl, {
            label: step.action,
            style: 'dashed'  // í”„ë¡œì„¸ìŠ¤ íë¦„ í‘œì‹œ
          });
        }

      } catch (error) {
        // 6. ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ í‘œì‹œ
        step.status = 'error';
        this.showError(step.targetElement, error.message);
      }
    }
  }

  calculatePosition(sourceElement: Element): Position {
    // ì›ë³¸ ìš”ì†Œ ì˜¤ë¥¸ìª½ì— ë°°ì¹˜
    return {
      x: sourceElement.position.x + sourceElement.width + 100,
      y: sourceElement.position.y
    };
  }
}
```

**ì‹¤í–‰ ì¤‘ ì‹œê°í™”**:

```
Before:
[HomeTax] â†’ [Excel]

During Execution:
[HomeTax] â”€â³ í…Œì´ë¸” ìŠ¤í¬ë˜í•‘ ì¤‘...â†’ [Excel]

After Execution:
[HomeTax] â”€â”€âœ… í…Œì´ë¸” ìŠ¤í¬ë˜í•‘ ì™„ë£Œâ”€â”€â†’ [Excel (ë°ì´í„° ì‚½ì…ë¨)]
                                        â†“
                                  [ğŸ“„ VAT_Report.pdf]  â† ìƒˆë¡œ ìƒì„±
```

#### 3. ê²°ê³¼ ë¦¬í¬íŠ¸ - Canvas Elementë¡œ ë Œë”ë§

```typescript
interface ExecutionReport {
  summary: string;
  steps: StepResult[];
  artifacts: Artifact[];  // ìƒì„±ëœ íŒŒì¼, ìŠ¤í¬ë¦°ìƒ· ë“±
  duration: number;
}

class ReportRenderer {
  async renderReport(report: ExecutionReport) {
    // 1. ë¦¬í¬íŠ¸ ì¹´ë“œë¥¼ ìº”ë²„ìŠ¤ì— ì¶”ê°€
    const reportElement = await this.canvas.addElement({
      type: 'report-card',
      title: 'ğŸ‰ ì‘ì—… ì™„ë£Œ',
      content: this.formatReport(report),
      position: this.findEmptySpace(),  // ë¹ˆ ê³µê°„ ì°¾ê¸°
      width: 400,
      height: 'auto'
    });

    // 2. Artifactsë¥¼ ê°œë³„ ìš”ì†Œë¡œ ë°°ì¹˜
    const artifactElements = await Promise.all(
      report.artifacts.map(artifact =>
        this.canvas.addElement({
          type: artifact.type,
          title: artifact.name,
          content: artifact.data,
          position: this.calculatePosition(reportElement),
          animation: 'slide-in'
        })
      )
    );

    // 3. ë¦¬í¬íŠ¸ì™€ artifacts ì—°ê²°
    artifactElements.forEach(el => {
      this.canvas.addArrow(reportElement, el, {
        label: 'ìƒì„±ë¨',
        style: 'solid'
      });
    });

    // 4. Viewportë¥¼ ë¦¬í¬íŠ¸ë¡œ ì´ë™
    await this.canvas.panTo(reportElement, {
      duration: 800,
      zoom: 1.0
    });

    // 5. Command Paletteì— ìš”ì•½ í‘œì‹œ
    this.commandPalette.show(`
      âœ… ì‘ì—… ì™„ë£Œ!

      ${report.summary}

      ìƒì„±ëœ íŒŒì¼: ${report.artifacts.length}ê°œ
      ì†Œìš” ì‹œê°„: ${report.duration}ì´ˆ

      [ìº”ë²„ìŠ¤ì—ì„œ ë³´ê¸° ğŸ“]
    `);
  }

  formatReport(report: ExecutionReport): string {
    return `
      ## ì‹¤í–‰ ê²°ê³¼

      ${report.summary}

      ### ë‹¨ê³„ë³„ ê²°ê³¼
      ${report.steps.map((step, i) => `
        ${i+1}. ${step.description}
           ${step.status === 'completed' ? 'âœ…' : 'âŒ'} ${step.message}
      `).join('\n')}

      ### ìƒì„±ëœ ìë£Œ
      ${report.artifacts.map(a => `- ${a.name}`).join('\n')}

      Total: ${report.duration}ì´ˆ
    `;
  }
}
```

**ìµœì¢… ìº”ë²„ìŠ¤ ìƒíƒœ**:

```
Workflow Completed View:

[HomeTax] â”€â”€âœ…â”€â”€â†’ [Excel] â”€â”€âœ…â”€â”€â†’ [Email Draft]
                    â†“
              [ğŸ“Š VAT_Report.pdf]
                    â†“
          â”Œâ”€ ğŸ‰ ì‘ì—… ì™„ë£Œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                        â”‚
          â”‚ VAT ë°ì´í„° ì¶”ì¶œ ë°      â”‚
          â”‚ ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ        â”‚
          â”‚                        â”‚
          â”‚ ë‹¨ê³„ë³„ ê²°ê³¼:            â”‚
          â”‚ 1. âœ… í…Œì´ë¸” ìŠ¤í¬ë˜í•‘   â”‚
          â”‚ 2. âœ… ë°ì´í„° ì •ì œ       â”‚
          â”‚ 3. âœ… PDF ìƒì„±         â”‚
          â”‚                        â”‚
          â”‚ ì†Œìš” ì‹œê°„: 8.3ì´ˆ        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4. Interactive Navigation Controls

```typescript
// ìš°ì¸¡ í•˜ë‹¨ ê³ ì • UI
<NavigationPanel>
  <StepIndicator>
    Step {currentStep} / {totalSteps}
  </StepIndicator>

  <ProgressBar value={currentStep / totalSteps} />

  <ButtonGroup>
    <Button onClick={previousStep} disabled={currentStep === 1}>
      â—€ ì´ì „
    </Button>

    <Button onClick={approveAndExecute} variant="primary">
      ìŠ¹ì¸ ë° ì‹¤í–‰ âœ…
    </Button>

    <Button onClick={nextStep} disabled={currentStep === totalSteps}>
      ë‹¤ìŒ â–¶
    </Button>
  </ButtonGroup>

  <Button onClick={cancelTour} variant="secondary">
    íˆ¬ì–´ ì¢…ë£Œ
  </Button>
</NavigationPanel>
```

---

## ì¢…í•© ìš”ì•½ ë° êµ¬í˜„ ìš°ì„ ìˆœìœ„

### í•µì‹¬ í•´ê²°ì±… ìš”ì•½

| ë¬¸ì œ | ì†”ë£¨ì…˜ | ê¸°ìˆ ì  ì ‘ê·¼ | êµ¬í˜„ ë‚œì´ë„ |
|------|--------|------------|------------|
| **#1, #8** ê±°ë¦¬ê°€ ë¨¼ ìš”ì†Œ ì„ íƒ/ì´ë™ | â€¢ Command Palette Quick Jump<br>â€¢ Minimap (ìš°ì¸¡í•˜ë‹¨)<br>â€¢ Magic Lasso (Cmd+Shift+ë“œë˜ê·¸)<br>â€¢ ë¶ë§ˆí¬ ì‹œìŠ¤í…œ (Cmd+1~9) | â€¢ ê²€ìƒ‰ ì¸ë±ì‹±<br>â€¢ Canvas ì¶•ì†Œë·° ë Œë”ë§<br>â€¢ Multi-select state ê´€ë¦¬ | â­â­ ì¤‘ê°„ |
| **#2** Multi-viewport ë Œë”ë§ | â€¢ **ì¶”ì²œ**: Offscreen Rendering + Canvas Clone<br>â€¢ ëŒ€ì•ˆ: í•˜ì´ë¸Œë¦¬ë“œ Reference Card | â€¢ Electron paint ì´ë²¤íŠ¸<br>â€¢ GPU texture ê³µìœ <br>â€¢ 60fps ë™ê¸°í™” ìµœì í™” | â­â­â­ ë†’ìŒ |
| **#3, #4** Context ê´€ë¦¬ | â€¢ 3-Tier Hierarchy (Active/Project/Archive)<br>â€¢ AI Orchestrator ìë™ ê´€ë¦¬<br>â€¢ Expert User Panel (í† í° budget í‘œì‹œ) | â€¢ Vector DB (RAG)<br>â€¢ Embedding ìœ ì‚¬ë„<br>â€¢ Context compression<br>â€¢ DBSCAN í´ëŸ¬ìŠ¤í„°ë§ | â­â­â­ ë†’ìŒ |
| **#5** Spatial Proximity ê°œì„  | â€¢ Viewport-first ì ‘ê·¼<br>â€¢ Omni-directional proximity (8ë°©í–¥)<br>â€¢ í™”ë©´ ë°– = ë‚®ì€ ìš°ì„ ë„ (0.1) | â€¢ Viewport intersection ê³„ì‚°<br>â€¢ ë™ì  relevance scoring<br>â€¢ Arrow/Cluster boost | â­â­ ì¤‘ê°„ |
| **#6** Context Feeding ì „ëµ | â€¢ Selected = Full Content<br>â€¢ Visible = Reference Only<br>â€¢ AI Tool Calling for More | â€¢ Prompt builder<br>â€¢ Tool calling framework<br>â€¢ Content extraction | â­â­ ì¤‘ê°„ |
| **#7** AI ì‹¤í–‰ ì‹œê°í™” | â€¢ Guided Tour ëª¨ë“œ<br>â€¢ Live Progress Indicator<br>â€¢ Canvas-integrated Report<br>â€¢ Navigation Controls | â€¢ Viewport animation<br>â€¢ Speech bubble overlay<br>â€¢ Dynamic element creation<br>â€¢ Arrow workflow viz | â­â­â­ ë†’ìŒ |

### êµ¬í˜„ ìš°ì„ ìˆœìœ„ (Phaseë³„)

#### Phase 1: Foundation (MVP) ğŸ¯

1. **#5 Spatial Proximity Model** - Core ì—”ì§„, ëª¨ë“  ê¸°ëŠ¥ì˜ ê¸°ë°˜
2. **#6 Context Feeding Strategy** - AIì™€ì˜ ìƒí˜¸ì‘ìš© ê¸°ë³¸
3. **#1/#8 Basic Navigation** - Minimap + Quick Jump (ë¶ë§ˆí¬ëŠ” Phase 2)

#### Phase 2: Context Intelligence ğŸ§ 

4. **#3 3-Tier Context Hierarchy** - ì„±ëŠ¥/ë¹„ìš© ìµœì í™” í•„ìˆ˜
5. **#4 Expert User Panel** - Context ê´€ë¦¬ UI (ìë™ ê´€ë¦¬ëŠ” Phase 3)
6. **#1/#8 Advanced Selection** - Magic Lasso, ë¶ë§ˆí¬ ì‹œìŠ¤í…œ

#### Phase 3: Advanced UX âœ¨

7. **#7 Workflow Visualization** - Guided Tour, Live Progress
8. **#2 Multi-viewport Rendering** - Reference Cardë¶€í„° ì‹œì‘, Offscreenì€ ì¶”í›„
9. **#4 AI Auto-Manage** - Context ìë™ í´ëŸ¬ìŠ¤í„°ë§/ì•„ì¹´ì´ë¹™

### ê¸°ìˆ  ìŠ¤íƒ ê³ ë ¤ì‚¬í•­

```typescript
// ê¶Œì¥ ë¼ì´ë¸ŒëŸ¬ë¦¬
{
  "canvas": "konva.js or fabric.js",  // ë¬´í•œ ìº”ë²„ìŠ¤
  "viewport": "react-zoom-pan-pinch",  // í™•ëŒ€/ì´ë™
  "vector-db": "chromadb or weaviate",  // RAG
  "embedding": "@anthropic/sdk (voyage-3)",  // Vector ìƒì„±
  "offscreen": "Electron WebContentsView",  // ë¸Œë¼ìš°ì € ë Œë”ë§
  "animation": "framer-motion",  // Viewport transition
  "minimap": "custom canvas layer"  // ì¶•ì†Œë·°
}
```

### ì„±ëŠ¥ ìµœì í™” í¬ì¸íŠ¸

1. **Viewport Culling**: í™”ë©´ ë°– ìš”ì†ŒëŠ” ë Œë”ë§ skip (virtual scrolling)
2. **Context Caching**: ë™ì¼ viewportëŠ” 30ì´ˆê°„ context ì¬ì‚¬ìš©
3. **Lazy Loading**: Archive contextëŠ” ê²€ìƒ‰ ì‹œì—ë§Œ ë¡œë“œ
4. **Debouncing**: Pan/Zoom ì¤‘ì—ëŠ” proximity ê³„ì‚° 300ms debounce
5. **Web Worker**: Embedding, proximity ê³„ì‚°ì€ ë³„ë„ ìŠ¤ë ˆë“œ

---

## ìµœì¢… UX Flow ì˜ˆì‹œ

### ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤: "ì„¸ê¸ˆ ë³´ê³ ì„œ ì‘ì„±"

```
1. ìº”ë²„ìŠ¤ ì´ˆê¸° ìƒíƒœ
   [HomeTax] [Excel] [Email]  â† ì‚¬ìš©ìê°€ ë°°ì¹˜

2. AI í˜¸ì¶œ (Cmd+K)
   User: "HomeTaxì—ì„œ VAT ë°ì´í„° ê°€ì ¸ì™€ì„œ ë³´ê³ ì„œ ë§Œë“¤ì–´ì¤˜"

3. Context ë¶„ì„ (ìë™)
   - Viewport: HomeTax (0.95), Excel (0.90), Email (0.85)
   - Selected: ì—†ìŒ
   - AIê°€ readElement(HomeTax) tool call

4. AI ê³„íš ì œì‹œ
   â”Œâ”€ ê³„íš (3ë‹¨ê³„) â”€â”€â”€â”€â”€â”€â”
   â”‚ 1. HomeTax ìŠ¤í¬ë˜í•‘ â”‚
   â”‚ 2. Excel ë°ì´í„° ì…ë ¥ â”‚
   â”‚ 3. PDF ë¦¬í¬íŠ¸ ìƒì„±   â”‚
   â”‚ [ë¯¸ë¦¬ë³´ê¸°] [ì‹¤í–‰]    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

5. Guided Tour ì‹œì‘
   â†’ HomeTaxë¡œ viewport ì´ë™
   â†’ Speech bubble: "ì´ í…Œì´ë¸”ì„ ìŠ¤í¬ë˜í•‘í•©ë‹ˆë‹¤"
   â†’ [â—€ ì´ì „] [ìŠ¹ì¸ âœ…] [ë‹¤ìŒ â–¶]

6. ì‹¤í–‰ ì¤‘
   [HomeTax] â”€â³ ìŠ¤í¬ë˜í•‘ ì¤‘...â†’ [Excel]

7. ê²°ê³¼ ì‹œê°í™”
   [HomeTax] â”€â”€âœ…â”€â”€â†’ [Excel] â”€â”€âœ…â”€â”€â†’ [ğŸ“„ VAT_Report.pdf]
                                      â†“
                             â”Œâ”€ ğŸ‰ ì‘ì—… ì™„ë£Œ â”€â”€â”€â”€â”
                             â”‚ 3ë‹¨ê³„ ëª¨ë‘ ì„±ê³µ    â”‚
                             â”‚ 8.3ì´ˆ ì†Œìš”        â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ê²°ë¡ 

EG-DESKì˜ Spatial Canvas UXëŠ” 8ê°€ì§€ í•µì‹¬ ë¬¸ì œë¥¼ í•´ê²°í•¨ìœ¼ë¡œì¨ ì§„ì •í•œ Ambient AI ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **Navigation**: ê±°ë¦¬ì™€ ê´€ê³„ì—†ì´ ë¹ ë¥¸ ìš”ì†Œ ì ‘ê·¼
2. **Multi-viewport**: íš¨ìœ¨ì ì¸ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ìœ¼ë¡œ ë™ì¼ ì½˜í…ì¸  ë‹¤ì¤‘ í‘œì‹œ
3. **Context ê´€ë¦¬**: ì§€ëŠ¥í˜• 3-Tier ì‹œìŠ¤í…œìœ¼ë¡œ ì„±ëŠ¥ê³¼ ë¹„ìš© ìµœì í™”
4. **Spatial Model**: Viewport ì¤‘ì‹¬ì˜ ë™ì  relevance ê³„ì‚°
5. **Context Feeding**: ëª…ì‹œì  ì„ íƒê³¼ ì•”ë¬µì  ì°¸ì¡°ì˜ í•˜ì´ë¸Œë¦¬ë“œ
6. **Workflow Viz**: ìº”ë²„ìŠ¤ í†µí•© ì‹œê°í™”ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ í”„ë¡œì„¸ìŠ¤ ì´í•´

êµ¬í˜„ ì‹œ Phase 1(Foundation) â†’ Phase 2(Context Intelligence) â†’ Phase 3(Advanced UX) ìˆœì„œë¡œ ì§„í–‰í•˜ì—¬ ì ì§„ì ìœ¼ë¡œ ì‚¬ìš©ì ê²½í—˜ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
